---
description: TypeScript2.6のリリース内容まとめ
---

# [TypeScript] 2.6

{{ page.meta.description }}


## [Strict function types]

[Strict function types]: https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-6.html#strict-function-types

{{label('had_better')}} {{label('hard')}}

`--strictFunctionTypes`フラグが追加された。
`--strict`が有効ならデフォルトで有効になる。

このフラグによって、関数の共変/反変性チェックルールが変わった。  
※ 関数にメソッドとコンストラクタは含まない

| --strictFunctionTypes フラグ | 関数                    | メソッド        | コンストラクタ  |
| ------------------------------ | ----------------------- | --------------- | --------------- |
| 無効                           | 双変(bivariant)         | 双変(bivariant) | 双変(bivariant) |
| 有効                           | **反変(contravariant)** | 双変(bivariant) | 双変(bivariant) |

=== "関数の代入"
    ```typescript
    class Animal {}
    class Dog extends Animal {
        bark(): void {}
    }
    class Cat extends Animal {
        meow(): void {}
    }

    declare let animalF: (x: Animal) => void;
    declare let dogF: (x: Dog) => void;
    declare let catF: (x: Cat) => void;

    // 共変(covariant)の場合代入できるケース
    //  * [NG] `--strictFunctionTypes` が有効なら反変(contravariant)ルールに従うため
    //  * [OK] `--strictFunctionTypes` が無効 または v2.6より前は双変(bivariant)ルールに従うため
    animalF = dogF
    
    // 反変(contravariant)の場合代入できるケース
    //  * [OK] `--strictFunctionTypes` が有効なら反変(contravariant)ルールに従うため
    //  * [OK] `--strictFunctionTypes` が無効 または v2.6より前は双変(bivariant)ルールに従うため
    dogF = animalF
    
    // 今も昔もエラー
    dogF = catF
    ```

=== "関数&ジェネリクス"
    ```typescript
    class Animal {}
    class Dog extends Animal {
      bark(): void {}
    }

    interface Comparer<T> {
      compare: (a: T, b: T) => number;
    }

    declare let animalComparer: Comparer<Animal>;
    declare let dogComparer: Comparer<Dog>;

    // 共変(covariant)の場合代入できるケース
    //  * [NG] `--strictFunctionTypes` が有効なら反変(contravariant)ルールに従うため
    //  * [OK] `--strictFunctionTypes` が無効 または v2.6より前は双変(bivariant)ルールに従うため
    animalComparer = dogComparer

    // 反変(contravariant)の場合代入できるケース
    //  * [OK] `--strictFunctionTypes` が有効なら反変(contravariant)ルールに従うため
    //  * [OK] `--strictFunctionTypes` が無効 または v2.6より前は双変(bivariant)ルールに従うため
    dogComparer = animalComparer
    ```

=== "メソッド&ジェネリクス"
    ```typescript
    class Animal {}
    class Dog extends Animal {
      bark(): void {}
    }

    interface Comparer<T> {
      compare(a: T, b: T): number;
    }

    declare let animalComparer: Comparer<Animal>;
    declare let dogComparer: Comparer<Dog>;

    // 共変(covariant)の場合代入できるケース
    //  * [OK] 宣言がメソッドで、メソッドパラメータのみにTが使われる場合は双変(bivariant)ルールに従うため
    animalComparer = dogComparer

    // 反変(contravariant)の場合代入できるケース
    //  * [OK] 宣言がメソッドで、メソッドパラメータのみにTが使われる場合は双変(bivariant)ルールに従うため
    dogComparer = animalComparer
    ```

